define(function(require, exports, module) {
	var BaseView=require("baseview");
	var Organization = BaseView.extend({
		initSubnav:function(){
			return {
				model:{
					title:"机构信息维护"
				}
			};
		},
		initList:function(widget){
			return {
				url : "api/organization/query",
				model:{
					columns:[{
						key:"name",
						name:"名称",
						format:"detail",
						formatparams:[{
							key:"detail",
							handler:function(index,data,rowEle){
								widget.edit("detail",data);
								return false;
							}
						}]
					},{
						key:"legalRepresentative",
						name:"法人"
					},{
						key:"zipCode",
						name:"邮编"      
					},{
						key:"address",
						name:"地址"
					},{
						key:"operate",
						name:"操作",
						format:"button",
						formatparams:[{
							key:"edit",
							icon:"edit",
							handler:function(index,data,rowEle){
								widget.edit("edit",data);
								return false;
							}
						},{
							key:"delete",
							icon:"remove",
							handler:function(index,data,rowEle){
								widget.del("api/organization/" + data.pkOrganization + "/delete");
								return false;
							}
						}]
					}]
				}
			};
		},
		initCard:function(widget){
			return {
				compType:"profile",
				saveaction:function(){
					widget.save("api/organization/add",$("#organization").serialize());
				},
				model:{
					id:"organization",
					items:[{
						title:"基本信息(必填)",
						icon:"github",
						remark:"",
						children:[{
							name:"pkOrganization",
							type:"hidden"
						},{
							name:"version",
							defaultValue:"0",
							type:"hidden"
						},{
							label:"名称",
							name:"name",
							validate:["required"]
						},{
							label:"法人",
							name:"legalRepresentative",
							validate:["required"]
						},{
							label:"邮编",
							name:"zipCode",
							validate:["required","postalcode"]
						},{
							label:"地址",
							name:"address",
							type:"textarea",
							validate:["required"]
						}]
					},{
						title:"联系人1(必填)",
						icon:"user",
						remark:"",
						children:[{
							label:"姓名",
							name:"contact1Name",
							validate:["required"]
						},{
							label:"联系电话",
							name:"contact1Phone",
							validate:["required"]
						},{
							label:"E-mail",
							name:"contact1Email",
							validate:["required","email"]
						},{
							label:"邮编",
							name:"contact1ZipCode",
							validate:["required","postalcode"]
						},{
							label:"地址",
							name:"contact1Address",
							type:"textarea",
							validate:["required",]
						}]
					},{
						title:"联系人2(非必填)",
						icon:"user",
						remark:"",
						children:[{
							label:"姓名",
							name:"contact2Name"
						},{
							label:"联系电话",
							name:"contact2Phone"
						},{
							label:"E-mail",
							name:"contact2Email",
							validate:["email"]
						},{
							label:"邮编",
							name:"contact2ZipCode",
							validate:["postalcode"]
						},{
							label:"地址",
							name:"contact2Address",
							type:"textarea"
						}]
					}]
				}
			};
		}
	});
	module.exports = Organization;
});