define("eling/component/ui/grid/1.0.0/dist/grid",["jquery/jquery-plugins/pagination/pagination","eling/component/core/uicomponent/2.0.0/src/uicomponent","base","tools","handlebars","templatable","bootstrap","gallery/handlebars/2.0.0/handlebars-seajs","eling/component/utils/ajaxwrapper","dialog","store","eling/component/utils/gridformat/gridformat","./grid.css","./grid.tpl"],function(a,b,c){a("jquery/jquery-plugins/pagination/pagination");var d=a("eling/component/core/uicomponent/2.0.0/src/uicomponent"),e=a("gallery/handlebars/2.0.0/handlebars-seajs"),f=a("eling/component/utils/ajaxwrapper"),g=a("eling/component/utils/gridformat/gridformat");a("./grid.css"),e.registerHelper("grid",function(a,b){var c;c=a.data&&a.data.records?a.data.records:a.data?a.data:{};for(var d=a.columns||[],e="",f=a.newIndex||0,h=a.idAttribute,i=0;i<c.length;i++){var j=g.getValue(h,c[i]);e+="<tr data-index='"+f+"' data-idAttribute='"+j+"'>",a.isCheckbox&&(e+="<td><input class='J-checked J-checkbox' type='checkbox'></td>"),a.isRadiobox&&(e+="<td><input class='J-checked J-radiobox' type='radio' name='grid-radiobox'></td>");for(var k=0;k<d.length;k++){var l=d[k].key||"",m=l.replace(".","_"),n=c[i]||"";n&&(n=g.getValue(l,c[i])||c[i][k]||""),e+=d[k].textAlign||a.textAlign?"<td style='text-align:"+(d[k].textAlign||a.textAlign||"")+";' class='J-"+m+" "+(d[k].className||"")+"'><pre>":"<td class='J-"+m+" "+(d[k].className||"")+"'><pre>";var o=d[k].format,p="";"function"==typeof o&&(p=o(n,c[i])),e+=g[o]||g[p]?g[o]?g[o](d[k].formatparams,n,c[i],a):g[p](d[k].formatparams,n,c[i],a):"function"==typeof o?o(n,c[i]):n,e+="</pre></td>"}e+="</tr>",f++}return e});var h=d.extend({attrs:{template:a("./grid.tpl"),parentNode:".J-list",isInitPageBar:!0,fetchProperties:"",data:[]},_loadData:function(a,b,c){var d=this,e=this.get("autoRender");if(0!=e){var g=b||d.get("params")||"";"function"==typeof g&&(g=g()),this.get("fetchProperties")&&(g=$.extend(!0,g,{fetchProperties:this.get("fetchProperties")}));var h=0==this.get("isInitPageBar")?!1:!0;this.loading();var b=f.customParam(g)||"";f.ajax({url:a,dataType:"json",type:"GET",data:b.substring(0,b.length-1),success:function(a){d.set("data",a),d._setData(a,h),d.element.find(".ajaxloader").parents("tr").remove(),"function"==typeof c&&c(a)},error:function(a){d._setData([],h)}})}},initCustAttr:function(){var a=this.get("model")||{};0==this.get("isInitPageBar")?a.isInitPageBar=!1:a.isInitPageBar=!0;var b=(a.columns,a.columns.length);(a.isCheckbox||a.isRadiobox)&&(b+=1),a.length=b},events:function(){for(var a=this,b={},c=this.get("model")||{},d=c.columns||[],e=0;e<d.length;e++)d[e].formatparams&&!function(c){for(var e=d[c].formatparams||[],f=0;f<e.length;f++)!function(c){b["click .J-"+(e[c].id||e[c].key)]=function(b){var d=this.getIndex(b.target),f=this.getSelectedData(d),g=this.element.find("tbody tr").eq(d),h=e[c].handler||function(){};h.apply(a,[d,f,g,b])}}(f)}(e);if(c.head)for(var f=c.head.buttons||[],g=0;g<f.length;g++)!function(c){b["click .J-grid-head-"+f[c].id]=function(){f[c].handler&&f[c].handler.call(a)}}(g);return c.isCheckbox&&(b["click .J-grid-all-checkbox"]=function(b){$(b.target).prop("checked")?a.$(".J-checked").prop("checked",!0):a.$(".J-checked").prop("checked",!1)}),b},setup:function(){this.render();var a=this.get("url");a&&this._loadData(a)},setData:function(a){a=a||[],this.set("data",a),this._setData(a,this.get("isInitPageBar"))},getData:function(){return this.get("data")},_setData:function(a,b){var c=this.get("model");c.data=a,this.renderPartial(".J-grid-table");var d=this.get("data"),e="共"+(this.get("isInitPageBar")?Math.ceil(d.length/(this.get("items_per_page")||15))+"页，"+d.length+"条记录":d.length+"条记录");this.$(".J-grid-total-info").text(e),b&&this._initPageBar(c.data.length)},_initPageBar:function(a){var b=this,c=this.get("model"),d=c.data||[];this.element.find(".J-pagination").pagination(a,{callback:function(c,e){var f=b.get("items_per_page")||15,g=c*f,h=Math.min((c+1)*f,a),i=d.slice(g,h);b._setData(i,!1)},link_to:"javascript:void(0);",items_per_page:b.get("items_per_page")||15,next_text:"下一页",prev_text:"上一页",num_display_entries:10,num_edge_entries:2})},refresh:function(a,b){this.set("autoRender",!0),this._loadData(this.get("url"),a,b)},getSelectedData:function(a){var b=this.get("model"),c=b.data;if(c){if(!a&&0!=a){var d=[];return this.element.find(".J-checked:checked").each(function(){var a=$(this).parents("tr").attr("data-index"),b=c[a];d.push(b)}),d}return c[a]}return{}},getIndex:function(a,b){return"1"==b?$(a).parents("tr").prevAll().size():$(a).parents("tr").attr("data-index")},setTitle:function(a){this.element.find(".J-grid-title").text(a)},getTitle:function(a){return this.element.find(".J-grid-title").text()},loading:function(){this.element.find(".J-grid-table").html("<tr><td class='ajaxloader' colspan='"+this.get("model").length+"'></td></tr>"),this.get("model").data=[]},hide:function(a){a.constructor===String&&(a=[a]);for(var b=0;b<a.length;b++)this.$(".J-grid-head-"+a[b]).addClass("hidden");return this},show:function(a){a.constructor===String&&(a=[a]);for(var b=0;b<a.length;b++)this.$(".J-grid-head-"+a[b]).removeClass("hidden");return this}});c.exports=h}),define("eling/component/ui/grid/1.0.0/dist/grid.css",[],function(){seajs.importStyle(".el-grid .ajaxloader{background:url(assets/eling/resources/ajaxloader/ajaxloader.gif) no-repeat;height:50px;background-position:50%}.el-grid tbody td{vertical-align:middle!important;word-break:break-word!important}.el-grid-multirow{height:30px;line-height:30px;padding:0 8px}.el-grid-multirow-border{border-bottom:1px solid #ddd}.el-grid .disabledrow{border:0 none;box-shadow:none;background:inherit}.el-grid td pre{background:inherit;border:0 none;padding:0;margin:0;word-wrap:break-word}@media print{.el-grid td{padding:0 2px!important}}")}),define("eling/component/ui/grid/1.0.0/dist/grid.tpl",[],"<div class='container el-grid {{this.id}}'>\n	<div class='row'>\n		<div class='col-xs-12'>\n			<div class='row'>\n				<div class='col-sm-12'>\n					<div class='box' style='margin-bottom:0;'>\n						{{#if this.head}}\n							<div class='box-header'>\n								<div class='title J-grid-title'>{{this.head.title}}</div>\n								<div class='actions'>\n									{{#each this.head.buttons}}\n									<div class=\"J-grid-head-{{this.id}} btn btn-theme\">\n										{{#if this.text}}\n										<a class=\"btn-theme\" href='javascript:void(0);'>\n											{{this.text}}\n										</a>\n										{{else}}\n										<a class=\"btn-theme\" href='javascript:void(0);'>\n											<i class=\"{{this.icon}}\"></i>\n										</a>\n										{{/if}}\n									</div>\n									{{/each}}\n								</div>\n								<div class='actions'>\n									{{#if this.head.input}}\n										<input class=\"J-grid-title-input-{{this.head.input.id}} form-control\" \n											type=\"text\" placeholder=\"{{this.head.input.placeholder}}\">\n									{{/if}}\n								</div>\n							</div>\n						{{/if}}\n						<div class='box-content box-no-padding'>\n							<table style='border:0 none;margin-bottom:0;' class='data-table-column-filter table table-bordered table-striped'>\n								<thead>\n    								<tr>\n    									{{#if this.isCheckbox}}\n    										<th style='border-bottom-width:0;width: 5%;'><input class='J-grid-all-checkbox' type='checkbox'></th>\n    									{{/if}}\n    									{{#if this.isRadiobox}}\n    										<th style='border-bottom-width:0;width: 5%;'></th>\n    									{{/if}}\n	    								{{#each this.columns}}\n	    									<th style='border-bottom-width:0;' class=\"col-md-{{this.col}} {{this.className}} text-center\">{{this.name}}</th>\n	    								{{/each}}\n    								</tr>\n  									</thead>\n  									<tbody class=\"J-grid-table\">\n    								{{#grid this}}\n    								{{/grid}}\n                				</tbody>\n               					<tfoot class=\"J-grid-footer\">\n                					<tr style=\"display: table-row !important;\">\n               							<th colspan='{{this.length}}' style=\"border-bottom: 0;\">\n               								<div class=\"J-grid-total-info\" style=\"float: left;margin-top: 5px;\"></div>\n               								<div class=\"J-pagination pagination\" style=\"float: right;margin: 0;\"></div>\n               							</th>\n                					</tr>\n                				</tfoot>\n                			</table>\n		                </div>\n		            </div>\n		        </div>\n		    </div>\n		</div>\n	</div>\n</div>");