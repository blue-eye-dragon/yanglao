define("eling/component/ui/subnav/1.0.0/dist/subnav",["eling/component/core/uicomponent/2.0.0/src/uicomponent","base","tools","handlebars","templatable","bootstrap","eling/component/utils/ajaxwrapper","dialog","store","gallery/handlebars/2.0.0/handlebars-seajs","./subnav.css","gallery/store/1.3.14/store-seajs","json","./plugins/button","eling/component/utils/fullscreen/fullscreen","./plugins/buttongroup","./plugins/buttongroup.tpl","./plugins/buttongroup_member.tpl","./plugins/time","bootstrap/bootstrap-plugins/daterangepicker/daterangepicker","./plugins/search","./plugins/date","jquery/jquery-plugins/datetimepicker/jquery.datetimepicker","./subnav.tpl"],function(a,b,c){var d=a("eling/component/core/uicomponent/2.0.0/src/uicomponent");a("eling/component/utils/ajaxwrapper"),a("gallery/handlebars/2.0.0/handlebars-seajs");a("./subnav.css");var e=(a("gallery/store/1.3.14/store-seajs"),a("./plugins/button")),f=a("./plugins/buttongroup"),g=a("./plugins/time"),h=a("./plugins/search"),i=a("./plugins/date"),j=a("gallery/handlebars/2.0.0/handlebars-seajs"),k={button:e,buttongroup:f,time:g,date:i,search:h};j.registerHelper("subnav",function(a,b){var c=a,d="",e=c.type||"text";return d+=c.format?c.format():k[e].getTemplate(c)});var l=d.extend({attrs:{template:a("./subnav.tpl"),autoRender:!0},initCustAttr:function(){for(var a=this.get("model"),b=a.items||this.transConfig(a),c=0;c<b.length;c++){var d=b[c].type;"function"==typeof k[b[c].type]._initCustAttr&&(b[c]=k[d]._initCustAttr(b[c],a)),b[c].type=d}a.items=b},events:function(){for(var a=this,b={},c=this.get("model"),d=c.items||[],e=0;e<d.length;e++)"function"==typeof k[d[e].type].events&&(b=$.extend(!0,b,k[d[e].type].events(d[e],a)));return b},afterRender:function(){for(var a=this.get("model"),b=a.items||[],c=0;c<b.length;c++)"function"==typeof k[b[c].type].initPlugins&&k[b[c].type].initPlugins(b[c],a)},transConfig:function(a){var b=[];if(a.search&&b.push({id:"search",type:"search",handler:a.search.handler||a.search,placeholder:a.search.placeholder}),a.buttonGroup)for(var c=a.buttonGroup,d=0;d<c.length;d++)c[d].type="buttongroup",b.push(c[d]);if(a.date){var e=a.date;e.handler=e.click,e.id="date",e.type="date";b.push(e)}if(a.time){var f=a.time;f.handler=f.click,f.id="time",f.type="time";b.push(f)}if(a.buttons)for(var g=a.buttons,h=0;h<g.length;h++)g[h].type="button",b.push(g[h]);return b},setTitle:function(a){this.$(".J-subnav-title").text(a)},getTitle:function(){return $(".J-subnav-title").text()},getItemConfig:function(a){var b=this.get("model")||{},c=b.items||[];if("string"!=typeof a)return c[a];for(var d=0;d<c.length;d++)if(c[d].id==a)return c[d]},hide:function(a){a.constructor===String&&(a=[a]);for(var b=0;b<a.length;b++){var c=this.getItemConfig(a[b]);this.$(".J-subnav-"+c.type+"-"+c.id).addClass("hidden")}return this},show:function(a){a.constructor===String&&(a=[a]);for(var b=0;b<a.length;b++){var c=this.getItemConfig(a[b]);this.$(".J-subnav-"+c.type+"-"+c.id).removeClass("hidden")}return this},getValue:function(a){var b=this.get("model"),c=this.getItemConfig(a);return k[c.type].getValue(c,b)},setValue:function(a,b){var c=this.get("model"),d=this.getItemConfig(a);k[d.type].setValue(d,c,b)},getText:function(a){var b=this.get("model"),c=this.getItemConfig(a);return k[c.type].getText(c,b)},setData:function(a,b){var c=this.get("model"),d=this.getItemConfig(a),e=d.type;k[e].setData(d,c,b)},getData:function(a,b){var c=this.get("model"),d=this.getItemConfig(a),e=d.type;return k[e].getData(d,c,{subIndex:b})},load:function(a){var b=this.get("model"),c=this.getItemConfig(a.id),d=c.type;k[d].load(c,b,a)},loading:function(a){var b=this.get("model"),c=this.getItemConfig(a),d=c.type;return k[d].loading(c,b)},destroy:function(){for(var a=this.get("model")||{},b=a.items||[],c=0;c<b.length;c++){var d=b[c].type||"text";"function"==typeof k[d].destroy&&k[d].destroy(b[c],a)}l.superclass.destroy.call(this,arguments)},getPlugin:function(a){return k[a]}});c.exports=l}),define("eling/component/ui/subnav/1.0.0/dist/subnav.css",[],function(){seajs.importStyle(".el-subnav-1 .el-page-header{margin:0 0 5px;overflow:inherit}.el-subnav-1 .el-pull-right{margin-right:6%}.el-subnav-1 .btn-group button{color:#fff}.el-subnav-1 .btn-group button span{border-top-color:#fff}.el-subnav-1 .ex-btn-group a b{border-top-color:#fff;margin-left:10px}.el-subnav-1 .ex-btn-group .tip{display:none;position:absolute;white-space:nowrap;top:100%;left:20px;z-index:1000;float:left;padding:5px;margin:2px 0 0;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #ccc;border:1px solid rgba(0,0,0,.15);border-radius:4px;-webkit-box-shadow:0 6px 12px rgba(0,0,0,.175);box-shadow:0 6px 12px rgba(0,0,0,.175)}.el-subnav-1 .dropdown-menu li a{margin-right:30px}")}),define("eling/component/ui/subnav/1.0.0/dist/plugins/button",["eling/component/utils/fullscreen/fullscreen","gallery/store/1.3.14/store-seajs","json"],function(a,b,c){var d=a("eling/component/utils/fullscreen/fullscreen"),e=(a("gallery/store/1.3.14/store-seajs"),{fullscreen:function(a){return{id:"fullscreen",text:"全屏",show:a.show||!0,handler:function(){return $("header").addClass("hidden"),$("nav").addClass("hidden"),$(".J-el-content").removeAttr("id"),$(".J-fullscreen").addClass("hidden"),$(".J-returnfullscreen").removeClass("hidden"),d.requestFullscreen(),a.callback&&a.callback(),!1}}},returnfullscreen:function(a){return{id:"returnfullscreen",text:"退出全屏",show:a.show||!1,handler:function(){return $("header").removeClass("hidden"),$("nav").removeClass("hidden"),$(".J-el-content").attr("id","content"),$(".J-fullscreen").removeClass("hidden"),$(".J-returnfullscreen").addClass("hidden"),d.exitFullscreen(),a.callback&&a.callback(),!1}}}}),f={getTemplate:function(a){return"<input class='btn btn-theme J-btn-"+a.id+"' value='"+a.text+"' type='button'>"},_initCustAttr:function(a,b){return e[a.id]&&(a=e[a.id](a)),a.show=0==a.show?"hidden":"",a},events:function(a,b){var c={};return c["click .J-btn-"+a.id]=function(){a.handler&&a.handler.call(b)},c},getValue:function(a,b){},setValue:function(){}};c.exports=f}),define("eling/component/ui/subnav/1.0.0/dist/plugins/buttongroup",["eling/component/utils/ajaxwrapper","dialog","store","gallery/store/1.3.14/store-seajs","json","gallery/handlebars/2.0.0/handlebars-seajs"],function(a,b,c){var d=a("eling/component/utils/ajaxwrapper"),e=a("gallery/store/1.3.14/store-seajs"),f=a("gallery/handlebars/2.0.0/handlebars-seajs"),g=a("eling/component/ui/subnav/1.0.0/dist/plugins/buttongroup.tpl"),h=a("eling/component/ui/subnav/1.0.0/dist/plugins/buttongroup_member.tpl"),i={_getValueWithPoint:function(a,b){var c="",d=b;if(a){var e=a.split(",");if(!(e.length>1)){for(var f=a.split("."),g=0;g<f.length;g++)d=d[f[g]]||0==d[f[g]]?d[f[g]]:"";return d}for(var h=0;h<e.length;h++)c+=this._getValueWithPoint(e[h],d)+" "}return c},transButtonGroup:function(a){delete a.main,delete a.sub;var b=a.items||[],c=a.key||"key",d=a.value||"value",e=a.format,f={key:"",text:"全部"+(a.showAllText||"")};if(b&&b[0]){var g;g="function"==typeof e?e(b[0]):i._getValueWithPoint(d,b[0]);for(var h=a.showAll&&a.showAllFirst?f:{key:i._getValueWithPoint(c,b[0]),text:g},j=[],k=0;k<b.length;k++){var l;l="function"==typeof e?e(b[k]):i._getValueWithPoint(d,b[k]),j.push({key:i._getValueWithPoint(c,b[k]),text:l})}a.showAll&&a.showAllFirst?j=[f].concat(j):a.showAll&&j.push(f),a.main=h,a.sub=j}else a.showAll?(a.items=[],a.main=f,a.sub=[f]):a.items=[];return a}},j={building:function(a){for(var b=e.get("user").buildings||[],c=[],d=0;d<b.length;d++)"Apartment"==b[d].useType.key&&c.push(b[d]);return{id:"building",type:"buttongroup",key:"pkBuilding",value:"name",items:c,show:a.show,showAll:a.showAll,showAllFirst:a.showAllFirst,tip:a.tip||"楼宇",handler:a.handler}},defaultMembers:function(a){return{id:"defaultMembers",type:"buttongroup",key:"pkMember",value:"memberSigning.room.number,personalInfo.name",url:"api/member/query",lazy:!0,tpl:h,show:a.show,showAll:a.showAll,showAllFirst:a.showAllFirst,tip:a.tip||"会员",handler:a.handler}}},k={getTemplate:function(a){var b="";if(0!=a.items.length){var c=a.main?a.main.key:"",d=a.main?a.main.text:"";b+="<button class='btn btn-theme J-btngroup-"+a.id+" J-main-"+a.id+"' data-key='"+c+"'>"+d+"</button>",b+="<button class='btn btn-theme J-btngroup-dropdown-"+a.id+" dropdown-toggle' data-toggle='dropdown'>",b+="<span class='caret' style='border-top-color: white;'></span>",b+="</button>",b+="<ul class='dropdown-menu'>";for(var e=a.sub||[],f=0;f<e.length;f++)b+="<li><a class='J-btngroup-"+a.id+"' data-key='"+e[f].key+"' href='javascript:void(0);'>"+e[f].text+"</a></li>";b+="</ul>",a.tip&&(b+="<div class='tip'>"+a.tip+"</div>")}return b},_initCustAttr:function(a,b){var c=a.id;return"function"==typeof j[c]&&(a=j[c](a)),a&&(a.show=0==a.show?"hidden":"",a=i.transButtonGroup(a),a.url&&1!=a.lazy&&d.ajax({url:a.url,data:a.params,dataType:"json",success:function(c){k.setData(a,b,c||[])}})),a},events:function(a,b){var c={};return c["click .J-btngroup-"+a.id]=function(c){var d=a.handler||function(){},e=$(c.target).is("a")||$(c.target).is("button")?$(c.target).attr("data-key"):$(c.target).parent().attr("data-key"),f=$(c.target).is("a")||$(c.target).is("button")?$(c.target).text():$(c.target).parent().text();return $(".J-main-"+a.id).attr("data-key",e).text(f),d.apply(b,[e,$(c.target),f]),!1},c["mouseover .J-main-"+a.id]=function(b){return $(b.target).parents(".J-subnav-buttongroup-"+a.id).find(".tip").css({display:"block"}),!1},c["mouseout .J-main-"+a.id]=function(b){return $(b.target).parents(".J-subnav-buttongroup-"+a.id).find(".tip").css({display:"none"}),!1},c},getValue:function(a,b){return $(".J-main-"+a.id).attr("data-key")||""},getText:function(a,b){return $(".J-main-"+a.id).text()||""},setValue:function(a,b,c){if(c){var d=$(".dropdown-menu .J-btngroup-"+a.id+"[data-key='"+c+"']").text();$(".J-main-"+a.id).attr("data-key",c).html(d)}else a.showAll&&$(".J-main-"+a.id).attr("data-key","").html("全部"+(a.showAllText||""))},load:function(a,b,c){this.loading(a);var e=c.url||a.url,f=c.params||a.params;"function"==typeof f&&(f=f()),d.ajax({url:e,data:f,dataType:"json",success:function(d){k.setData(a,b,d);var e=c.callback||function(){};e(d)}})},loading:function(a,b){$(".J-subnav-buttongroup-"+a.id).html($("<button></button>").addClass("btn").addClass("btn-theme").text("正在加载"))},setData:function(a,b,c){a.items=c,a=i.transButtonGroup(a);var d=a.tpl||g,e=f.compile(d)(a);$(".dropdown.J-subnav-buttongroup-"+a.id).html(e)},getData:function(a,b,c){var d=a.items,e=c.subIndex;if(void 0===e)return d;if("number"==typeof e)return d[e];for(var f in d)if(d[f][a.key]==e)return d[f]}};c.exports=k}),define("eling/component/ui/subnav/1.0.0/dist/plugins/buttongroup.tpl",[],'{{#if this.main}}\n	<button class="btn btn-theme J-btngroup-{{this.id}} J-main-{{this.id}}" data-key="{{this.main.key}}">{{this.main.text}}</button>\n	<button class="btn btn-theme J-btngroup-dropdown-{{this.id}} dropdown-toggle" data-toggle="dropdown">\n		<span class="caret" style="border-top-color: white;"></span>\n	</button>\n	<ul class="dropdown-menu">\n		{{#each this.sub}}\n			<li><a class="J-btngroup-{{../this.id}}" data-key="{{this.key}}" href="javascript:void(0);">{{this.text}}</a></li>\n		{{/each}}\n	</ul>\n	{{#if this.tip}}\n	<div class="tip">{{this.tip}}</div>\n	{{/if}}\n{{/if}}\n'),define("eling/component/ui/subnav/1.0.0/dist/plugins/buttongroup_member.tpl",[],'{{#if this.items}}\n<button class="btn btn-theme J-btngroup-defaultMembers J-main-defaultMembers" data-key="{{this.main.key}}">{{this.main.text}}</button>\n<button class="btn btn-theme J-btngroup-dropdown-defaultMembers dropdown-toggle" data-toggle="dropdown">\n	<span class="caret" style="border-top-color: white;"></span>\n</button>\n<ul class="dropdown-menu" style="overflow: auto;max-height: 310px;">\n	{{#each this.sub}}\n		<li>\n			<a class="J-btngroup-defaultMembers" data-key="{{this.key}}" href="javascript:void(0);">{{this.text}}</a>\n		</li>\n	{{/each}}\n</ul>\n<div class="tip">{{this.tip}}</div>\n{{/if}}\n'),define("eling/component/ui/subnav/1.0.0/dist/plugins/time",["bootstrap/bootstrap-plugins/daterangepicker/daterangepicker"],function(a,b,c){a("bootstrap/bootstrap-plugins/daterangepicker/daterangepicker");var d={getTemplate:function(a){var b="";return b+="<a class='btn btn-theme dropdown-toggle J-daterange' href='javascript:void(0);'>",b+="<span>请选择时间</span>",b+="<b class='caret'></b>",b+="</a>",a.tip&&(b+="<div class='tip'>"+a.tip+"</div>"),b},initPlugins:function(a,b){var c=a,d=c.ranges||{"今天":[moment().startOf("days"),moment().endOf("days")],"昨天":[moment().subtract(1,"days").startOf("days"),moment().subtract(1,"days").endOf("days")],"本月":[moment().startOf("month"),moment().endOf("month")]};"function"==typeof d&&(d=d());var e=c.defaultTime||{},f=d[e]?d[e][0]:moment().startOf("month"),g=d[e]?d[e][1]:moment().endOf("month"),h={};for(var i in d){var j=d[i];h[i]=[];for(var k=0;k<j.length;k++)h[i].push(j[k].valueOf())}var l=$(".J-daterange").daterangepicker({format:"YYYY.MM.DD",ranges:h,showDropdowns:!0,minDate:a.minDate||"1900",maxDate:a.maxDate,singleDatePicker:a.singleDatePicker,locale:{applyLabel:"确定",cancelLabel:"取消",fromLabel:"从",toLabel:"到",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1},startDate:f.format("YYYY.MM.DD"),endDate:g.format("YYYY.MM.DD"),opens:"left",buttonClasses:["btn","btn-sm"]},function(b,c){var d=b.format("YYYY.MM.DD"),e=c.format("YYYY.MM.DD");d==e?$(".J-daterange span").html(d):$(".J-daterange span").html(d+"-"+e),"function"==typeof a.handler&&a.handler({start:b.valueOf(),end:c.valueOf()})});l.on("show.daterangepicker",function(){l.data("daterangepicker").showCalendars()}),f.format("YYYY.MM.DD")==g.format("YYYY.MM.DD")?$(".J-daterange span").html(f.format("YYYY.MM.DD")):$(".J-daterange span").html(f.format("YYYY.MM.DD")+"-"+g.format("YYYY.MM.DD"))},events:function(a,b){var c={};return c["mouseover .J-subnav-time-"+a.id]=function(b){return $(b.target).parents(".J-subnav-time-"+a.id).find(".tip").css({display:"block"}),!1},c["mouseout .J-subnav-time-"+a.id]=function(b){return $(b.target).parents(".J-subnav-time-"+a.id).find(".tip").css({display:"none"}),!1},c},getValue:function(){var a=$(".J-daterange span").text(),b=a.split("-");for(var c in b)b[c]=b[c].replace(/\./g,"-");return{start:moment(b[0]).startOf("days").valueOf(),end:2==b.length?moment(b[1]).endOf("days").valueOf():moment(b[0]).endOf("days").valueOf()}},setValue:function(a,b,c){var d=c.start,e=c.end,f=moment(d).format("YYYY.MM.DD"),g=moment(e).format("YYYY.MM.DD");f==g?$(".J-daterange span").text(f):$(".J-daterange span").text(f+"-"+g)}};c.exports=d}),define("eling/component/ui/subnav/1.0.0/dist/plugins/search",[],function(a,b,c){var d={getTemplate:function(a){return"<input style='width: 160px; ' class='form-control input-sm J-subnav-search-"+a.id+"' placeholder='"+(a.placeholder||"搜索")+"'>"},events:function(a){var b={};return b["keydown input.J-subnav-search-"+a.id]=function(b){var c;if(c=window.event?b.keyCode:b.which,13==c){var d=$("input.J-subnav-search-"+a.id).val();d&&a.handler(d)}},b},getValue:function(a,b){return $("input.J-subnav-search-"+a.id).val()},setValue:function(a,b,c){$("input.J-subnav-search-"+a.id).val(c)}};c.exports=d}),define("eling/component/ui/subnav/1.0.0/dist/plugins/date",["jquery/jquery-plugins/datetimepicker/jquery.datetimepicker"],function(a,b,c){a("jquery/jquery-plugins/datetimepicker/jquery.datetimepicker");var d={_transMode:function(a){return a?a.replace("Y","yyyy").replace("m","MM").replace("d","dd").replace("H","hh").replace("i","mm"):"yyyy-MM-dd"},getTemplate:function(a){var b=a.defaultDate||moment().format("YYYY-MM-DD");return"<input class='btn btn-theme J-subnav-date-"+a.id+"' value='"+b+"' type='button'>"},initPlugins:function(a,b){var c={format:"Y-m-d",lang:"zh",timepicker:!1,closeOnDateSelect:!0,onSelectDate:function(b,c){if("function"==typeof a.handler){var d=moment(b).startOf("days").valueOf(),e=moment(b).add("days",1).startOf("days").valueOf()-1;a.handler(d,e)}}};a.startDate&&(c.startDate=a.startDate),a.maxDate&&(c.maxDate=a.maxDate),a.minDate&&(c.minDate=a.minDate),$("input.J-subnav-date-"+a.id).datetimepicker(c)},getValue:function(a,b){var c=$("input.J-subnav-date-"+a.id).val();return{start:moment(c).startOf("days").valueOf(),end:moment(c).add("days",1).startOf("days").valueOf()-1}},setValue:function(a,b,c){$("input.J-subnav-date-"+a.id).val(moment(c).format("YYYY-MM-DD"))},destroy:function(a,b){$("input.J-subnav-date-"+a.id).datetimepicker("destroy")}};c.exports=d}),define("eling/component/ui/subnav/1.0.0/dist/subnav.tpl",[],"<div id=\"{{this.id}}\" class=\"container el-subnav el-subnav-1\">\n	<div class='row'>\n		<div class='col-sm-12'>\n			<div class='page-header el-page-header J-subnav-head'>\n				<h1 class='pull-left'>\n					<i class='icon-comments'></i>\n					<span class=\"J-subnav-title\">{{this.title}}</span>\n				</h1>\n				<div class='pull-right el-pull-right'>\n				{{#each this.items}}\n					<div class=\"btn-group ex-btn-group dropdown J-{{this.id}} J-subnav-{{this.type}}-{{this.id}} {{this.show}}\">\n						{{#subnav this}}\n						{{/subnav}}\n					</div>\n				{{/each}}\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n");