define("eling/component/ui/profile/1.0.0/dist/profile",["eling/component/ui/form/1.0.0/dist/form","eling/component/core/uicomponent/2.0.0/src/uicomponent","base","tools","handlebars","templatable","bootstrap","gallery/handlebars/2.0.0/handlebars-seajs","eling/component/utils/ajaxwrapper","dialog","store","jquery/jquery-plugins/validate/jquery.validate","jquery/jquery-plugins/datetimepicker/jquery.datetimepicker","jquery/jquery-plugins/select2/select2","eling/component/ui/admindivision/1.0.0/dist/admindivision","jquery/jquery-plugins/autocomplete/autocomplete","jquery/jquery-plugins/ajaxfileupload/ajaxfileupload","eling/component/utils/dialog/1.0.0/dist/dialog","eling/component/utils/loadimgage/loadimage-debug","./profile.tpl"],function(a,b,c){var d=a("eling/component/ui/form/1.0.0/dist/form");a("eling/component/utils/ajaxwrapper");a("jquery/jquery-plugins/ajaxfileupload/ajaxfileupload");var e=a("eling/component/utils/dialog/1.0.0/dist/dialog"),f=(a("eling/component/utils/loadimgage/loadimage-debug"),d.extend({attrs:{template:a("./profile.tpl"),autoRender:!0,personalization:"",model:{saveText:"保存",cancelText:""}},getPersonalizationConfig:function(a,b){JSON.parse(b);for(var c in a){var d=columns[c].name,e=custConfig[d];0!=e.show&&custColumns.push(columns[c])}return custColumns},initCustAttr:function(a){for(var b=this.get("model")||{},c=b.items||[],d=[],e=0;e<c.length;e++)for(var g=c[e].children||[],h=0;h<g.length;h++){var i=g[h].id||g[h].name;a&&a[i]&&(g[h].show=a[i].isShow?"":"hidden");for(var j=g[h].validate||[],k=0;k<j.length;k++)"required"==j[k]&&(g[h].isRequired=!0);d.push(g[h])}f.superclass.initCustAttr.call(this,d)},events:function(){for(var a=this,b=[],c=this.get("model")||{},d=c.items||[],g=0;g<d.length;g++)for(var h=d[g].children||[],i=0;i<h.length;i++)b.push(h[i]);var j=f.superclass.events.call(this,b),k=this.get("isUpload");return k!==!1&&(j["click .J-profile-fileupload"]=function(b){a.$("#J-profile-fileupload-form").click()},j["change #J-profile-fileupload-form"]=function(a){var b;if(a.target.files&&0!=a.target.files.length)b=a.target.files[0].size;else{var c=$(".J-profile-fileupload").attr("src",$("#J-profile-fileupload-form").val());b=c.fileSize}if(b>=2097152)return void e.alert({content:"上传文件大小不能超过2M"});var d=loadImage(a.target.files[0]);$(".J-profile-fileupload").attr("src",d.src)}),j},afterRender:function(){this._initValidate();for(var a=[],b=this.get("model")||{},c=b.items||[],d=0;d<c.length;d++)for(var e=c[d].children||[],f=0;f<e.length;f++)a.push(e[f]);this._initPlugins(a,this.element),this.loadPicture()},setData:function(a){for(var b=[],c=this.get("model")||{},d=c.items||[],e=0;e<d.length;e++)for(var g=d[e].children||[],h=0;h<g.length;h++)b.push(g[h]);f.superclass.setData.call(this,a,b),d[0]&&d[0].img&&this.loadPicture()},reset:function(){for(var a=[],b=this.get("model")||{},c=b.items||[],d=0;d<c.length;d++)for(var e=c[d].children||[],g=0;g<e.length;g++)a.push(e[g]);f.superclass.reset.call(this,a),$("#J-profile-fileupload-form").val(""),this.loadPicture()},loadPicture:function(a){var b=this.get("model").items;if(b&&b[0].img){var c=b[0].img,d=c.url,e=c.idAttribute;if($(".J-"+e).is("select")){var f=$(".J-"+e).find("option:selected").val();$("img.J-profile-fileupload").attr("src",a||d+(f||0))}else $("img.J-profile-fileupload").attr("src",a||d+($(".J-"+e).val()||0))}},upload:function(a,b){var c=this.get("model").items;if(c&&c[0].img){var d=c[0].img;$("#J-profile-fileupload-form").val()?$.ajaxFileUpload({url:a?a:d.url+$(".J-"+d.idAttribute).val(),secureuri:!1,fileElementId:"J-profile-fileupload-form",dataType:"json",success:function(a){b&&b(a)}}):b&&b()}},getItemConfig:function(a){for(var b=[],c=this.get("model")||{},d=c.items||[],e=0;e<d.length;e++)for(var g=d[e].children||[],h=0;h<g.length;h++)b.push(g[h]);return f.superclass.getItemConfig.call(this,a,b)},getSubData:function(){for(var a=this.get("model"),b=$("#"+a.id).serializeArray(),c=0,d=a.items||[],e=[],f=0;f<d.length;f++){var g={},h=d[f].children;for(j=0;j<h.length;j++,c++)g[h[j].name]=b[c].value;e.push(g)}return e}}));c.exports=f}),define("eling/component/ui/profile/1.0.0/dist/profile.tpl",[],"<div class='container el-profile'>\n	<div class='row'>\n		<div class='col-sm-12 col-lg-12'>\n        	<div class='box'>\n        		<div class='box-content box-double-padding'>\n        			<form class='form' style='margin-bottom: 0;' id={{this.id}}>\n        			{{#each this.items}}\n        				<fieldset>\n        					{{#if this.title}}\n        						{{#if this.children}}\n        							<div class='col-sm-4'>\n	        					{{else}}\n	        						<div class='col-sm-12'>\n	        					{{/if}}\n			        					<div class='lead'>\n		        							<i class='icon-{{this.icon}} text-contrast'></i>{{this.title}}\n		        						</div>\n		        						{{#if this.remark}}\n		        						<small class='text-muted'>{{this.remark}}</small>\n		        						{{/if}}\n		        						{{#if this.img}}\n		        						<small class='text-muted'>\n		        							<img class=\"img-responsive J-profile-fileupload\" style=\"width:200px;height:200px;background-color:cornsilk;border:1px solid\"/>\n		        						</small>\n		        						{{/if}}\n		        					</div>\n        					{{/if}}\n        					{{#if this.title}}\n        						<div class='col-sm-7'>\n        					{{else}}\n        						<div class='col-sm-12'>\n        					{{/if}}\n       							{{#each this.children}}\n       								<div class=\"form-group {{this.type}} {{this.show}}\">\n       									<label>{{this.label}}</label>\n       									{{#if this.isRequired}}\n										<span style=\"color: red;\">*</span>\n										{{/if}}\n		        						{{#form_1_0_0 this}}\n		        						{{/form_1_0_0}}\n	        						</div>\n       							{{/each}}\n        					</div>\n        				</fieldset>\n        				<hr class='hr-normal'>\n        			{{/each}}\n        			{{#if this.defaultButton}}\n        			<div class='J-button-area form-actions form-actions-padding' style='margin-bottom: 0;'>\n        				<div class='text-right'>\n        					<button class='J-save J-form-save J-form-{{this.id}}-save btn btn-lg btn-theme' type=\"submit\">\n        						<i class='icon-save'></i>\n        						<span class=\"J-form-{{this.id}}-saveText J-form-saveText\">{{this.saveText}}</span>\n        					</button>\n        					{{#if this.cancelText}}\n        					<a class='J-cancel J-form-cancel J-form-{{this.id}}-cancel btn btn-lg' href=\"javascript:void(0);\">{{this.cancelText}}</a>\n        					{{/if}}\n        				</div>\n        			</div>\n        			{{/if}}\n        			</form>\n        		</div>\n        	</div>\n        </div>\n    </div>\n    <div class=\"hidden\">\n    	<form id=\"photoform\" enctype=\"multipart/form-data\" target=\"hidden_iframe\" method=\"post\">\n			<input name=\"file\" type=\"file\" id=\"J-profile-fileupload-form\" class=\"hidden\"/>\n		</form>\n		<iframe name=\"hidden_iframe\" class=\"J-picframe hidden\"></iframe>\n    </div>\n</div>\n\n");