define(function(require,exports,module){
	var Backbone=require("backbone");
	Backbone.emulateJSON=true;
	Backbone.emulateHTTP=true;
	
	
	//eling ui组件
	var Form=require("form-2.0.0")
    var Dialog=require("dialog-1.0.0");
	
	//utils
	var BaseDoc=require("basedoc");
	var Properties=require("../../properties");
	
	var MemOtherView=Backbone.View.extend({
		initialize:function(model){
			this.model=model;
			this.render();
		},
		render:function(){
			this.component=this.initComponent(this);
			this.$el=this.component.element;
			this.$parentEL=this.$el.parents(".el-member");
		},
		initComponent:function(view){
			return new Form({
				parentNode:"#step5",
				saveaction:function(){
					Dialog.alert({
                		title:"提示",
                		showBtn:false,
                		content:"正在保存，请稍后……"
                	});
					var params=$("#baseinfo").serialize()+"&"+$("#otherform").serialize()+"&"+"fetchProperties="+Properties.mem_baseinfo;
					view.model.save({},{
						//配置silent为true，则保存成功之后不触发change事件，手动触发另外一个事件
						silent:true,
						url:"api/member/save",
						data:params,
						error:function(){
							Dialog.close();	
						},
						success:function(model, response){
							Dialog.close();	
							view.$parentEL.removeClass("edit").addClass("list").removeClass("member");
							view.model.trigger("_change");
						}
					});
				},
				model:{
					id:"otherform",
					items:[{
						name:"professionalTitle",
						label:"技术职称",
						type:"radiolist",
						list:BaseDoc.professionalTitle
					},{
						name:"topJobTitle",
						label:"最高职位级别",
						type:"radiolist",
						list:BaseDoc.jobTitle
					},{
						name:"jobTitleBeforeRetire",
						label:"离退休前职位级别",
						type:"radiolist",
						list:BaseDoc.jobTitle
					},{
						name:"retireType",
						label:"离退休类型",
						type:"radiolist",
						list:[{
							key:"PublicInstitutions",
							value:"机关事业单位离退休"
						},{
							key:"EnterpriseUnits",
							value:"企业单位离退休"
						},{
							key:"Rural",
							value:"农村社会保险养老金"
						},{
							key:"Townlet",
							value:"小城镇社会保险养老金"
						}]
					},{
						name:"specialTreatment",
						label:"特殊待遇",
						type:"radiolist",
						list:[{
							key:"Retire",
							value:"离休"
						},{
							key:"SpecialAllowance",
							value:"国务院特殊津贴"
						},{
							key:"Other",
							value:"其他"
						}]
					},{
						name:"retirementPay",
						label:"离退休月收入",
						type:"radiolist",
						list:[{
							key:"LE3000",
							value:"小于3000"
						},{
							key:"F3001T5000",
							value:"3001-5000"
						},{
							key:"F5001T8000",
							value:"5001-8000元"
						},{
							key:"GR8000",
							value:"8000以上"
						}]
					},{
						name:"overseasExperience",
						label:"海外经历",
						type:"select",
						url:"api/country/query",
						key:"pkCountry",
						value:"name",
						multi:true
					},{
						name:"ffl",
						label:"第一外语"
					},{
						name:"fflDof",
						label:"第一外语熟练程度",
						type:"radiolist",
						list:[{
							key:"UNTOUCH",
							value:"未接触过"
						},{
							key:"COMMONLY",
							value:"一般"
						},{
							key:"GOOD",
							value:"良好"
						},{
							key:"SKILLED",
							value:"熟练"
						},{
							key:"MASTER",
							value:"精通"
						}]
					},{
						name:"sfl",
						label:"第二外语"
					},{
						name:"sflDof",
						label:"第二外语熟练程度",
						type:"radiolist",
						list:[{
							key:"UNTOUCH",
							value:"未接触过"
						},{
							key:"COMMONLY",
							value:"一般"
						},{
							key:"GOOD",
							value:"良好"
						},{
							key:"SKILLED",
							value:"熟练"
						},{
							key:"MASTER",
							value:"精通"
						}]
					},{
						name:"computerDof",
						label:"计算机能力",
						type:"radiolist",
						list:[{
							key:"UNTOUCH",
							value:"未接触过"
						},{
							key:"COMMONLY",
							value:"一般"
						},{
							key:"GOOD",
							value:"良好"
						},{
							key:"SKILLED",
							value:"熟练"
						},{
							key:"MASTER",
							value:"精通"
						}]
					},{
						name:"otherIntroduction",
						label:"其他介绍",
						type:"textarea"
					}]
				}
			});
		},
		destroy:function(){
			this.component.destroy();
		}
	});
	
	module.exports=MemOtherView;
});